<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Firma de Contrato - The Lift</title>
</head>
<body style="font-family: sans-serif; margin: 20px;">
  <h1>Contrato de Servicios</h1>

  <div style="height: 400px; overflow-y: scroll; border: 1px solid #ccc; padding: 15px; margin-bottom: 20px;">
    <p>Contrato de prestación de servicios profesionales...</p>
    <p>[Aquí iría todo el texto largo del contrato.]</p>
    <p>Última página del contrato...</p>
  </div>

  <h2>Firma y Datos</h2>

  <form onsubmit="return enviarContrato()">
    <label>Nombre completo:</label><br>
    <input type="text" name="nombre" required><br><br>

    <label>Dirección:</label><br>
    <input type="text" name="direccion" required><br><br>

    <label>Correo electrónico:</label><br>
    <input type="email" name="correo" required><br><br>

    <label>Puesto:</label><br>
    <input type="text" name="puesto" required><br><br>

    <label>Fecha de servicio:</label><br>
    <input type="date" name="fecha_servicio" required><br><br>

    <label>Lugar de firma:</label><br>
    <input type="text" name="lugar_firma"><br><br>

    <label>Departamento:</label><br>
    <select name="departamento" required>
      <option value="">Selecciona una opción</option>
      <option value="Cámara">Cámara</option>
      <option value="Producción">Producción</option>
      <option value="Arte">Arte</option>
      <option value="Otro">Otro</option>
    </select><br><br>

    <label>¿Tienes representante?</label><br>
    <input type="checkbox" id="representante" name="representante" value="sí"> Sí<br><br>

    <label>Firma:</label><br>
    <canvas id="firmaCanvas" width="300" height="150" style="border:1px solid #000;"></canvas><br><br>
    <button type="button" onclick="clearSignature()">Borrar Firma</button><br><br>

    <button type="submit">Enviar contrato firmado</button>
  </form>

  <!-- Librería de firma -->
  <script src="https://cdn.jsdelivr.net/npm/signature_pad@2.3.2/dist/signature_pad.min.js"></script>

  <script>
    // Inicializar Signature Pad
    const canvas = document.getElementById('firmaCanvas');
    const signaturePad = new SignaturePad(canvas);

    function clearSignature() {
      signaturePad.clear();
    }

    function getSignatureImage() {
      if (signaturePad.isEmpty()) {
        alert("Por favor firma antes de enviar.");
        return null;
      } else {
        return signaturePad.toDataURL();
      }
    }

    function enviarContrato() {
      const firmaBase64 = getSignatureImage();

      if (!firmaBase64) {
        // Si no hay firma, no enviamos
        return false;
      }

      // Recolectar datos del formulario
      const nombre = document.querySelector('input[name="nombre"]').value;
      const direccion = document.querySelector('input[name="direccion"]').value;
      const correo = document.querySelector('input[name="correo"]').value;
      const puesto = document.querySelector('input[name="puesto"]').value;
      const fechaServicio = document.querySelector('input[name="fecha_servicio"]').value;
      const lugarFirma = document.querySelector('input[name="lugar_firma"]').value;
      const departamento = document.querySelector('select[name="departamento"]').value;
      const representante = document.querySelector('input[name="representante"]').checked ? "Sí" : "No";

      const datos = {
        nombre,
        direccion,
        correo,
        puesto,
        fechaServicio,
        lugarFirma,
        departamento,
        representante,
        firmaBase64
      };

      console.log(datos);
      alert("Datos capturados correctamente. (Revisa consola para ver los datos)");

      return false; // No recargar la página
    }
  </script>
</body>
</html>
